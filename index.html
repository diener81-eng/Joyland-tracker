<!DOCTYPE html>
<html lang="en">
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Joyland Tracker</title>

<style>
  body {
    font-family: system-ui, sans-serif;
    background: #0f0f0f;
    color: #fff;
    text-align: center;
    padding: 1rem;
  }

  h2 { margin-bottom: .3rem; }

  .desc {
    font-size: 0.95rem;
    color: #ccc;
    margin-bottom: 1rem;
    max-width: 500px;
    margin-left: auto;
    margin-right: auto;
  }

  button {
    font-size: 1.1rem;
    padding: 1rem;
    margin: .35rem;
    width: 90%;
    max-width: 420px;
    border-radius: 12px;
    border: none;
  }

  .tiny { background: #444; }
  .axe { background: #c0392b; }
  .card { background: #2980b9; }
  .block { background: #27ae60; }
  .jackpot { background: #f1c40f; color: #000; }
  .crossroads { background: #16a085; }
  
  .undo { background: #8e44ad; }
  .reset { background: #555; }

  .divider {
    margin: 1.2rem auto;
    width: 90%;
    max-width: 420px;
    border-top: 1px solid #333;
  }

  .history {
    max-height: 120px;
    overflow-y: auto;
    background: #181818;
    border-radius: 10px;
    padding: .5rem;
    font-size: .9rem;
    color: #ccc;
    margin: .75rem auto;
    width: 90%;
    max-width: 420px;
    text-align: left;
  }

  .timeline {
    display: flex;
    justify-content: center;
    flex-wrap: wrap;
    margin-top: 1rem;
  }

  .cell {
    width: 26px;
    height: 26px;
    margin: 3px;
    border-radius: 6px;
    background: #333;
    font-size: 0.8rem;
    line-height: 26px;
  }

  .done { background: #666; }
  .current { background: #3498db; }
  .warning { background: #e67e22; }

  .alert {
    margin-top: .5rem;
    font-size: 1.1rem;
    font-weight: bold;
    color: #ff9f43;
  }

  .cell {
  width: 26px;
  height: 26px;
  margin: 3px 3px 8px 3px;  /* bottom margin increased from 3px to 8px */
  border-radius: 6px;
  background: #333;
  font-size: 0.8rem;
  line-height: 28px;  /* slightly taller for letters */
  text-align: center;
  }
  
</style>
</head>

<body>

<h2>Joyland Tracker</h2>

<div class="desc">
  Tap each event as it appears in Joyland.<br>
  This tracker finds your sequence and warns you when to 
  <b>use 50x compass on Axe Ricochet and Card Realm</b>.
</div>

<!-- INPUT BUTTONS -->
<button class="tiny" onclick="log('Tiny Adventures')">T 路 Tiny Adventures</button>
<button class="crossroads" onclick="log('Crossroads of Fate')">F 路 Crossroads of Fate</button>
<button class="axe" onclick="log('Axe Ricochet')">A 路 Axe Ricochet</button>
<button class="card" onclick="log('Card Realm')">C 路 Card Realm</button>
<button class="block" onclick="log('Blocks Duel')">B 路 Blocks Duel</button>
<button class="jackpot" onclick="log('Jackpot')">J 路 Jackpot</button>

<!-- STATUS -->
<pre id="status"></pre>
<div class="alert" id="alert"></div>

<!-- HISTORY -->
<div class="history" id="history"></div>

<!-- TIMELINE -->
<div class="timeline" id="timeline"></div>

<!-- CONTROLS -->
<div class="divider"></div>
<button class="undo" onclick="undo()">Undo Last Tap</button>
<button class="reset" onclick="reset()">Reset Cycle</button>

<script>
const sequences = {
  1:["Tiny Adventures","Crossroads of Fate","Tiny Adventures","Blocks Duel","Tiny Adventures","Tiny Adventures","Crossroads of Fate","Card Realm","Tiny Adventures","Crossroads of Fate","Tiny Adventures","Blocks Duel","Jackpot"],
  2:["Tiny Adventures","Tiny Adventures","Axe Ricochet","Tiny Adventures","Crossroads of Fate","Card Realm","Tiny Adventures","Tiny Adventures","Crossroads of Fate","Jackpot","Crossroads of Fate","Tiny Adventures","Blocks Duel"],
  3:["Tiny Adventures","Tiny Adventures","Crossroads of Fate","Card Realm","Tiny Adventures","Tiny Adventures","Axe Ricochet","Tiny Adventures","Crossroads of Fate","Jackpot","Tiny Adventures","Blocks Duel","Crossroads of Fate"],
  4:["Tiny Adventures","Tiny Adventures","Card Realm","Tiny Adventures","Crossroads of Fate","Tiny Adventures","Axe Ricochet","Tiny Adventures","Crossroads of Fate","Tiny Adventures","Crossroads of Fate","Axe Ricochet","Jackpot"]
};

const abbrev = {
  "Tiny Adventures": "T",
  "Axe Ricochet": "A",
  "Card Realm": "C",
  "Blocks Duel": "B",
  "Jackpot": "J",
  "Crossroads of Fate": "F"
};
  
  
let history = [];
let possibilities = [];

function reset() {
  history = [];
  possibilities = [];
  document.getElementById("status").textContent = "Cycle reset.";
  document.getElementById("timeline").innerHTML = "";
  document.getElementById("history").innerHTML = "";
  document.getElementById("alert").textContent = "";
}

function undo() {
  if (!history.length) return;
  history.pop();
  rebuild();
}

function rebuild() {
  possibilities = [];
  history.forEach(e => process(e));
  render();
}

function log(event) {
  history.push(event);
  process(event);
  render();
}

function process(event) {
  if (!possibilities.length) {
    for (const [seq, moves] of Object.entries(sequences)) {
      moves.forEach((m, i) => {
        if (m === event) possibilities.push({ seq, move: i + 1 });
      });
    }
  } else {
    possibilities = possibilities
      .filter(p => sequences[p.seq][p.move] === event)
      .map(p => ({ seq: p.seq, move: p.move + 1 }));
  }
}

function render() {
  const status = document.getElementById("status");
  const timeline = document.getElementById("timeline");
  const historyBox = document.getElementById("history");
  const alert = document.getElementById("alert");

  timeline.innerHTML = "";
  historyBox.innerHTML = history
    .map((e, i) => `${i + 1}. ${e}`)
    .join("<br>");

  status.textContent =
    `Moves logged: ${history.length}\n` +
    `Possible positions: ${possibilities.length}`;

  alert.textContent = "";

  if (possibilities.length !== 1) return;

  const p = possibilities[0];
  const moves = sequences[p.seq];

  status.textContent =
    `Sequence ${p.seq}\n` +
    `Move ${p.move} / 13`;

  const upcoming = moves.slice(p.move);
  const warnIndex = upcoming.findIndex(m =>
    m === "Axe Ricochet" || m === "Card Realm"
  );

if (warnIndex === 0) {
  alert.textContent = " ENABLE 50x NOW ";
} else if (warnIndex > 0) {
  status.textContent +=
    `\nNext ${upcoming[warnIndex]} at move ${p.move + warnIndex + 1}`;
}
  
  
  moves.forEach((m, i) => {
  const cell = document.createElement("div");
  cell.className = "cell";

  if (i + 1 < p.move) cell.classList.add("done");
  if (i + 1 === p.move) cell.classList.add("current");
  if (warnIndex >= 0 && i + 1 === p.move + warnIndex)
    cell.classList.add("warning");

  let letter = abbrev[m];
if (letter === "A" || letter === "C") letter = `<b>${letter}</b>`;
cell.innerHTML = `<small>${i + 1}</small><br>${letter}`; 
if (m === "Axe Ricochet" || m === "Card Realm") {
  cell.style.border = "2px solid white";
}
    timeline.appendChild(cell);
    
});

}
</script>

</body>
</html>
